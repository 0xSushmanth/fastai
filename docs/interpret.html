---

title: Interpretation of Predictions


keywords: fastai
sidebar: home_sidebar

summary: "Classes to build objects to better interpret predictions of a model"
description: "Classes to build objects to better interpret predictions of a model"
nb_path: "nbs/20_interpret.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/20_interpret.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Interpretation" class="doc_header"><code>class</code> <code>Interpretation</code><a href="https://github.com/fastai/fastai/tree/master/fastai/interpret.py#L26" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>Interpretation</code>(<strong><code>learn</code></strong>:<a href="/learner.html#Learner"><code>Learner</code></a>, <strong><code>dl</code></strong>:<a href="/data.load.html#DataLoader"><code>DataLoader</code></a>, <strong><code>losses</code></strong>:<a href="/torch_core.html#TensorBase"><code>TensorBase</code></a>, <strong><code>act</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Interpretation base class, can be inherited for task specific Interpretation classes</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>learn</code></strong></td>
<td><a href="/learner.html#Learner"><code>Learner</code></a></td>
<td></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>dl</code></strong></td>
<td><a href="/data.load.html#DataLoader"><code>DataLoader</code></a></td>
<td></td>
<td><a href="/data.load.html#DataLoader"><code>DataLoader</code></a> to run inference over</td>
</tr>
<tr>
<td><strong><code>losses</code></strong></td>
<td><a href="/torch_core.html#TensorBase"><code>TensorBase</code></a></td>
<td></td>
<td>Losses calculated from <code>dl</code></td>
</tr>
<tr>
<td><strong><code>act</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Activation function for prediction</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/interpret.html#Interpretation"><code>Interpretation</code></a> is a helper base class for exploring predictions from trained models. It can be inherited for task specific interpretation classes, such as <a href="/interpret.html#ClassificationInterpretation"><code>ClassificationInterpretation</code></a>. <a href="/interpret.html#Interpretation"><code>Interpretation</code></a> is memory efficient and should be able to process any sized dataset, provided the hardware could train the same model.
{% include note.html content='<a href="/interpret.html#Interpretation"><code>Interpretation</code></a> is memory efficient due to generating inputs, predictions, targets, decoded outputs, and losses for each item on the fly, using batch processing where possible.' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Interpretation.from_learner" class="doc_header"><code>Interpretation.from_learner</code><a href="https://github.com/fastai/fastai/tree/master/fastai/interpret.py#L46" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>Interpretation.from_learner</code>(<strong><code>learn</code></strong>, <strong><code>ds_idx</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>dl</code></strong>:<a href="/data.load.html#DataLoader"><code>DataLoader</code></a>=<em><code>None</code></em>, <strong><code>act</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Construct interpretation object from a learner</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>learn</code></strong></td>
<td></td>
<td></td>
<td>Model used to create interpretation</td>
</tr>
<tr>
<td><strong><code>ds_idx</code></strong></td>
<td><code>int</code></td>
<td><code>1</code></td>
<td>Index of <code>learn.dls</code> when <code>dl</code> is None</td>
</tr>
<tr>
<td><strong><code>dl</code></strong></td>
<td><a href="/data.load.html#DataLoader"><code>DataLoader</code></a></td>
<td><code>None</code></td>
<td><code>Dataloader</code> used to make predictions</td>
</tr>
<tr>
<td><strong><code>act</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Override default or set prediction activation function</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Interpretation.top_losses" class="doc_header"><code>Interpretation.top_losses</code><a href="https://github.com/fastai/fastai/tree/master/fastai/interpret.py#L59" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>Interpretation.top_losses</code>(<strong><code>k</code></strong>:<code>(int, None)</code>=<em><code>None</code></em>, <strong><code>largest</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>items</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p><code>k</code> largest(/smallest) losses and indexes, defaulting to all losses.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>k</code></strong></td>
<td><code>(int, None)</code></td>
<td><code>None</code></td>
<td>Return <code>k</code> losses, defaults to all</td>
</tr>
<tr>
<td><strong><code>largest</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Sort losses by largest or smallest</td>
</tr>
<tr>
<td><strong><code>items</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Whether to return input items</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the default of <code>k=None</code>, <code>top_losses</code> will return the entire dataset's losses. <code>top_losses</code> can optionally include the input items for each loss, which is usually a file path or Pandas <code>DataFrame</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Interpretation.plot_top_losses" class="doc_header"><code>Interpretation.plot_top_losses</code><a href="https://github.com/fastai/fastai/tree/master/fastai/interpret.py#L69" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>Interpretation.plot_top_losses</code>(<strong><code>k</code></strong>:<code>(int, list)</code>, <strong><code>largest</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Show <code>k</code> largest(/smallest) preds and losses. Implementation based on type dispatch</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>k</code></strong></td>
<td><code>(int, list)</code></td>
<td></td>
<td>Number of losses to plot</td>
</tr>
<tr>
<td><strong><code>largest</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Sort losses by largest or smallest</td>
</tr>
<tr>
<td><strong><code>kwargs</code></strong></td>
<td></td>
<td></td>
<td><em>No Content</em></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To plot the first 9 top losses:</p>
<div class="highlight"><pre><span></span><span class="n">interp</span> <span class="o">=</span> <span class="n">Interpretation</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learn</span><span class="p">)</span>
<span class="n">interp</span><span class="o">.</span><span class="n">plot_top_losses</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
</pre></div>
<p>Then to plot the 7th through 16th top losses:</p>
<div class="highlight"><pre><span></span><span class="n">interp</span><span class="o">.</span><span class="n">plot_top_losses</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Interpretation.show_results" class="doc_header"><code>Interpretation.show_results</code><a href="https://github.com/fastai/fastai/tree/master/fastai/interpret.py#L89" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>Interpretation.show_results</code>(<strong><code>idxs</code></strong>:<code>list</code>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Show predictions and targets of <code>idxs</code></p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>idxs</code></strong></td>
<td><code>list</code></td>
<td></td>
<td>Indices of predictions and targets</td>
</tr>
<tr>
<td><strong><code>kwargs</code></strong></td>
<td></td>
<td></td>
<td><em>No Content</em></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Like <a href="/learner.html#Learner.show_results"><code>Learner.show_results</code></a>, except can pass desired index or indicies for item(s) to show results from.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ClassificationInterpretation" class="doc_header"><code>class</code> <code>ClassificationInterpretation</code><a href="https://github.com/fastai/fastai/tree/master/fastai/interpret.py#L101" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ClassificationInterpretation</code>(<strong><code>learn</code></strong>:<a href="/learner.html#Learner"><code>Learner</code></a>, <strong><code>dl</code></strong>:<a href="/data.load.html#DataLoader"><code>DataLoader</code></a>, <strong><code>losses</code></strong>:<a href="/torch_core.html#TensorBase"><code>TensorBase</code></a>, <strong><code>act</code></strong>=<em><code>None</code></em>) :: <a href="/interpret.html#Interpretation"><code>Interpretation</code></a></p>
</blockquote>
<p>Interpretation methods for classification models.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>learn</code></strong></td>
<td><a href="/learner.html#Learner"><code>Learner</code></a></td>
<td></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>dl</code></strong></td>
<td><a href="/data.load.html#DataLoader"><code>DataLoader</code></a></td>
<td></td>
<td><a href="/data.load.html#DataLoader"><code>DataLoader</code></a> to run inference over</td>
</tr>
<tr>
<td><strong><code>losses</code></strong></td>
<td><a href="/torch_core.html#TensorBase"><code>TensorBase</code></a></td>
<td></td>
<td>Losses calculated from <code>dl</code></td>
</tr>
<tr>
<td><strong><code>act</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Activation function for prediction</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="ClassificationInterpretation.confusion_matrix" class="doc_header"><code>ClassificationInterpretation.confusion_matrix</code><a href="https://github.com/fastai/fastai/tree/master/fastai/interpret.py#L114" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>ClassificationInterpretation.confusion_matrix</code>()</p>
</blockquote>
<p>Confusion matrix as an <code>np.ndarray</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="ClassificationInterpretation.plot_confusion_matrix" class="doc_header"><code>ClassificationInterpretation.plot_confusion_matrix</code><a href="https://github.com/fastai/fastai/tree/master/fastai/interpret.py#L123" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>ClassificationInterpretation.plot_confusion_matrix</code>(<strong><code>normalize</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>title</code></strong>:<code>str</code>=<em><code>'Confusion matrix'</code></em>, <strong><code>cmap</code></strong>:<code>str</code>=<em><code>'Blues'</code></em>, <strong><code>norm_dec</code></strong>:<code>int</code>=<em><code>2</code></em>, <strong><code>plot_txt</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Plot the confusion matrix, with <code>title</code> and using <code>cmap</code>.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>normalize</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Whether to normalize occurrences</td>
</tr>
<tr>
<td><strong><code>title</code></strong></td>
<td><code>str</code></td>
<td><code>Confusion matrix</code></td>
<td>Title of plot</td>
</tr>
<tr>
<td><strong><code>cmap</code></strong></td>
<td><code>str</code></td>
<td><code>Blues</code></td>
<td>Colormap from matplotlib</td>
</tr>
<tr>
<td><strong><code>norm_dec</code></strong></td>
<td><code>int</code></td>
<td><code>2</code></td>
<td>Decimal places for normalized occurrences</td>
</tr>
<tr>
<td><strong><code>plot_txt</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Display occurrence in matrix</td>
</tr>
<tr>
<td><strong><code>kwargs</code></strong></td>
<td></td>
<td></td>
<td><em>No Content</em></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="ClassificationInterpretation.most_confused" class="doc_header"><code>ClassificationInterpretation.most_confused</code><a href="https://github.com/fastai/fastai/tree/master/fastai/interpret.py#L157" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>ClassificationInterpretation.most_confused</code>(<strong><code>min_val</code></strong>=<em><code>1</code></em>)</p>
</blockquote>
<p>Sorted descending largest non-diagonal entries of confusion matrix (actual, predicted, # occurrences</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SegmentationInterpretation" class="doc_header"><code>class</code> <code>SegmentationInterpretation</code><a href="https://github.com/fastai/fastai/tree/master/fastai/interpret.py#L173" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SegmentationInterpretation</code>(<strong><code>learn</code></strong>:<a href="/learner.html#Learner"><code>Learner</code></a>, <strong><code>dl</code></strong>:<a href="/data.load.html#DataLoader"><code>DataLoader</code></a>, <strong><code>losses</code></strong>:<a href="/torch_core.html#TensorBase"><code>TensorBase</code></a>, <strong><code>act</code></strong>=<em><code>None</code></em>) :: <a href="/interpret.html#Interpretation"><code>Interpretation</code></a></p>
</blockquote>
<p>Interpretation methods for segmentation models.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>learn</code></strong></td>
<td><a href="/learner.html#Learner"><code>Learner</code></a></td>
<td></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>dl</code></strong></td>
<td><a href="/data.load.html#DataLoader"><code>DataLoader</code></a></td>
<td></td>
<td><a href="/data.load.html#DataLoader"><code>DataLoader</code></a> to run inference over</td>
</tr>
<tr>
<td><strong><code>losses</code></strong></td>
<td><a href="/torch_core.html#TensorBase"><code>TensorBase</code></a></td>
<td></td>
<td>Losses calculated from <code>dl</code></td>
</tr>
<tr>
<td><strong><code>act</code></strong></td>
<td></td>
<td><code>None</code></td>
<td>Activation function for prediction</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

